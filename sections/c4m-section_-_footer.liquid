{% schema %}
{
  "name": "⚒️ Custom Footer",
  "settings": [
    {
      "type": "image_picker",
      "id": "footer_logo",
      "label": "Footer Logo"
    },
    {
      "type": "link_list",
      "id": "footer_menu",
      "label": "Footer Menu"
    },
    {
      "type": "text",
      "id": "newsletter_title",
      "label": "Newsletter Title",
      "default": "Subscribe to our newsletter"
    },
    {
      "type": "text",
      "id": "klaviyo_list_id",
      "label": "Klaviyo List ID"
    },
    {
      "type": "url",
      "id": "facebook_url",
      "label": "Facebook URL",
      "default": "/"
    },
    {
      "type": "url",
      "id": "instagram_url",
      "label": "Instagram URL",
      "default": "/"
    }
  ],
    "presets": [
    {
      "name": "⚒️ Custom Footer"
    }
  ]
}
{% endschema %}




{% assign current_url = request.host | append: request.fullpath %}
{% assign current_url_scheme = request.protocol | append: '://' %}

<div class="footer page-width">
  <img class="footer-logo" src="{{ section.settings.footer_logo | img_url: '200x' }}" alt="Footer Logo">
  
  {% assign footer_menu = menus[section.settings.footer_menu] %}
  <div class="footer-grid">
    {% for link in footer_menu.links limit: 3 %}
<div class="footer-column">
  <div class="footer-column__toggle" data-collapsed="true">
    <h4>{{ link.title }}</h4>
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path d="M8 9.4L2.7 4.1 1.3 5.5l6 6 .7.7.7-.7 6-6-1.4-1.4L8 9.4z"></path></svg>
  </div>
  <ul class="footer-column__list">
    {% for child_link in link.links %}
    <li><a href="{{ child_link.url }}">{{ child_link.title }}</a></li>
    {% endfor %}
  </ul>
</div>
{% endfor %}
  
    <div class="footer-column column4">
      <div class="newsletter">
          <h4>Newsletter</h4>
          <form action="//manage.kmail-lists.com/ajax/subscriptions/subscribe" method="post" enctype="multipart/form-data">
            <input type="hidden" name="g" value="{{ section.settings.klaviyo_list_id }}">
            <input type="email" name="email" placeholder="Enter your email" required>
            <button type="submit">Subscribe</button>
          </form>
          <p class="newsletter-success" style="display:none;">Thanks for subscribing!</p>
          <p class="newsletter-error" style="display:none;">Oops! Something went wrong. Please try again.</p>
      </div>
      <div class="social-media">
        <h4>Follow us</h4>
        <ul>
          <li><a href="{{ section.settings.facebook_url }}" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Pro 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg></a></li>
          <li><a href="{{ section.settings.instagram_url }}" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Pro 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"/></svg></a></li>
        </ul>
      </div>
    </div>
  </div>
            
  <div class="footer_credits">
    <p class="credits">© 2021 - 2023 Two Pillars, LLC. All Rights Reserved.</p>
  </div>

    
</div>
</div>




{% javascript %}
document.addEventListener('DOMContentLoaded', function() {
  var newsletterForm = document.querySelector('.newsletter form');
  var subscriptionMessage = document.querySelector('.subscription-message');

  function showMessage(message) {
    subscriptionMessage.textContent = message;
    subscriptionMessage.style.display = 'block';
  }

  newsletterForm.addEventListener('submit', function(event) {
    event.preventDefault();

    var formData = new FormData(newsletterForm);
    var xhr = new XMLHttpRequest();
    xhr.open('POST', newsletterForm.getAttribute('action'), true);
    xhr.setRequestHeader('Accept', 'application/json');
    xhr.onreadystatechange = function() {
      if (xhr.readyState === XMLHttpRequest.DONE) {
        if (xhr.status === 200) {
          showMessage('Thank you for subscribing!');
          newsletterForm.reset();
        } else {
          showMessage('Something went wrong. Please try again later.');
        }
      }
    };
    xhr.send(formData);
  });







  function toggleFooterColumn(event) {
    const toggle = event.currentTarget;
    const column = toggle.parentElement;
    const list = column.querySelector('.footer-column__list');
    const isCollapsed = toggle.getAttribute('data-collapsed') === 'true';

    if (isCollapsed) {
      list.style.maxHeight = list.scrollHeight + 'px';
      toggle.setAttribute('data-collapsed', 'false');
    } else {
      list.style.maxHeight = '0';
      toggle.setAttribute('data-collapsed', 'true');
    }
  }
  

  // Add event listeners to the footer-column__toggle elements
  document.querySelectorAll('.footer-column__toggle').forEach(toggle => {
    toggle.addEventListener('click', toggleFooterColumn);
  });
  
});
{% endjavascript %}

